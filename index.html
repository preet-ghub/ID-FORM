<!DOCTYPE html>
<html>
<head>
<title>ID Form</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">
</head>
<body>
  <form id="myForm" enctype="multipart/form-data" method="post">
    
    
    <header><h1>ID CARD FORM</h1>
        <h3><i>session : 2025-2026</i></h3>
    </header>
    <main>
        <div>
            Name : <input type="text" name="name" placeholder="Your name" >
            <br><br>
            Father's Name : <input type="text" name="fatherName" placeholder="Your Father's Name" >
            <br><br>
            Mother's Name : <input type="text" name="motherName" placeholder="Your Mother's Name" >
            <br><br>
            Phone Number : <input type="tel" name="phone" placeholder="Your Phone no"  oninput="this.value = this.value.replace(/[^0-9]/g, '')" maxlength="10" required>
            <br><br>
            Guardian Number : <input type="tel" name="guardianPhone" placeholder="Your Guardian no" oninput="this.value = this.value.replace(/[^0-9]/g, '')" maxlength="10" required>
            <br><br>
            Class Name : <input type="text" name="admissionNo" placeholder="Your Class" >
            <br><br>
            Roll Number : <input type="text" name="rollNo" placeholder="Your Roll no" >
            <br><br>
            Section : <input type="text" name="section" placeholder="Your Section" maxlength="1" >
            <br><br>
            Email : <input type="email" name="email" placeholder="Your Email" >
            <br><br>
             Date Of Birth : <input type="date" name="dob" >
             <br><br>
             Address :<br>
             <textarea name="address" rows="5" cols="26"></textarea>
             <br><br>
             Upload Your Photo : <input type="file" id="photo" name="photoLink" accept="image/*" >
             <br>
             
             <button type="submit">Submit</button>
        </div>
    </main>
    <footer></footer>
      <p>&copy; 2025 All Rights Reserved | Designed by Preet</p>
    </footer>
    
  </form>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbwoevDNKOzl48vHbznfx7_XbgYyoCrWNdIsnAMcZBzS9f-ih5J3_wOnev8HbGWIQsoktg/exec"; 
  
    document.getElementById('myForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const fd = new FormData(form);
  
      // ✅ Format DOB (YYYY-MM-DD → DD-MM-YYYY)
      const dob = fd.get("dob");
      if (dob) {
        const [year, month, day] = dob.split("-");
        const formattedDOB = `${day}-${month}-${year}`;  
        fd.set("dob", formattedDOB);
      }
  
      // Convert selected photo to base64 and send that instead of the raw file
      const fileInput = document.getElementById('photo');
      if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        const base64 = await fileToBase64(file);       
        const clean = base64.split(',')[1] || base64;  
        fd.set('photoLink', clean);                    // send base64 string in "photoLink"
      } else {
        fd.delete('photoLink');
      }
  
      const res = await fetch(scriptURL, { method: 'POST', body: fd });
      const text = await res.text();
      alert(text);
      form.reset();
    });
  
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }
  </script>
  
  
   
</body>
</html>
